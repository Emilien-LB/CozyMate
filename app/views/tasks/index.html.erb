<h1 class="text-center">Tasks</h1>

<div class="flexbox search-bar">
  <%= form_with url: tasks_path, method: :get, id: 'search-form' do %>
    <%= text_field_tag :query, params[:query], placeholder: "Search ..." %>
    <button type="submit" class="search-button">
      <i class="fas fa-search"></i>
    </button>
  <% end %>
</div>

<script>
 document.addEventListener('DOMContentLoaded', function() {
  const searchForm = document.getElementById('search-form');

  if (searchForm) {  // Vérification si searchForm est null
    const searchInput = searchForm.querySelector('input[type="text"]');

    if (searchInput) {  // Vérification si searchInput est null
      searchInput.addEventListener('input', function() {
        if (searchInput.value === '') {
          searchForm.submit();
        }
      });
    } else {
      console.error("L'élément input[type=\"text\"] n'a pas été trouvé dans le formulaire.");
    }
  } else {
    console.error("Le formulaire avec l'ID 'search-form' n'a pas été trouvé.");
  }
});
</script>


<div class="container text-center">
  <div class="daily d-flex flex-column justify-content-center">
    <h2>Daily</h2>
    <% @tasks.where(frequency_type: 'daily').each do |task| %>
      <div>
        <%= link_to task_path(task), class: 'task-link text-decoration-none' do %>
          <%= task.task_name %>
          <%= task.points %>
          <i class="fa-regular fa-star" style="color: #a2cdb0;"></i>
          <%= link_to task_path(task), data: { turbo_method: :delete, turbo_confirm: "Are you sure?" }, class: "text-decoration-none" do %>
            <i class="fa-solid fa-trash-can" style="color: #8d5ba5;"></i>
          <%end%>
           <%= link_to edit_task_path(task), class: "text-decoration-none" do %>
            <i class="fa-solid fa-paintbrush" style="color: #a2cdb0;"></i>
          <%end%>
      <%end%>
      </div>
    <% end %>
  </div>

  <div class="daily d-flex flex-column justify-content-center">
    <h2>Weekly</h2>
    <% @tasks.where(frequency_type: 'weekly').each do |task| %>
      <div>
        <%= link_to task_path(task), class: 'task-link text-decoration-none' do %>
          <%= task.task_name %>
          <%= task.points %>
          <i class="fa-regular fa-star" style="color: #a2cdb0;"></i>
          <%= link_to task_path(task), data: { turbo_method: :delete, turbo_confirm: "Are you sure?" }, class: "text-decoration-none" do %>
            <i class="fa-solid fa-trash-can" style="color: #8d5ba5;"></i>
          <%end%>
           <%= link_to edit_task_path(task), class: "text-decoration-none" do %>
            <i class="fa-solid fa-paintbrush" style="color: #a2cdb0;"></i>
          <%end%>
        <%end%>
      </div>
    <% end %>
  </div>

  <div class="daily d-flex flex-column justify-content-center">
    <h2>Monthly</h2>
    <% @tasks.where(frequency_type: 'monthly').each do |task| %>
      <div>
        <%= link_to task_path(task), class: 'task-link text-decoration-none' do %>
          <%= task.task_name %>
            <%= task.points %>
            <i class="fa-regular fa-star" style="color: #a2cdb0;"></i>
            <%= link_to task_path(task), data: { turbo_method: :delete, turbo_confirm: "Are you sure?" }, class: "text-decoration-none" do %>
              <i class="fa-solid fa-trash-can" style="color: #8d5ba5;"></i>
            <%end%>
            <%= link_to edit_task_path(task), class: "text-decoration-none" do %>
              <i class="fa-solid fa-paintbrush" style="color: #a2cdb0;"></i>
            <%end%>
        <%end%>
      </div>
    <% end %>
  </div>
  
  <%= link_to new_task_path do %>
    <i class="fa-solid fa-circle-plus fa-2xl" style="color: #ffd1cc;"></i>
  <%end%>
</div>
